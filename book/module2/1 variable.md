
# ตัวแปรและฟังก์ชัน

```{margin} คำศัพท์
*ตัวแปร (variable)* วิธีการเก็บข้อมูลโดยกำหนดชื่อเรียกให้กับค่าที่เก็บ

*การกำหนดค่าให้ตัวแปร (variable assignment)* การเชื่อมโยงชื่อตัวแปรกับค่าที่ต้องการเก็บ

```

## ตัวแปร (variable)
ลองนึกถึงสมัยประถมที่เราเริ่มเรียนวิธีการตั้งหารยาว หรือการคูณเลขสามหลักด้วยมือ ซึ่งก็มีอัลกอริธึมที่ค่อนข้างซับซ้อนที่ต้องทำด้วยมือซ้ำๆ จนชำนาญ อย่างหนึ่งที่สังเกตจากการตั้งหารยาวคือ ต้องมีการทดเลข จดไว้สักที่หนึ่ง เพื่อจะนำเอาผลการคูณหารของเลขแต่ละหลักมารวมกันอีกครั้งตอนสุดท้ายที่เพื่อที่จะได้ผลลัพธ์สุดท้าย  การทดเลข เปรียบได้กับการเก็บข้อมูลเอาไว้ในตัวแปรเพื่อจะนำมาใช้ทีหลัง 

การเก็บข้อมูลใส่ตัวแปรเพื่อนำค่ามาใช้ทีหลัง เรียกว่า *การกำหนดค่าให้ตัวแปร (variable assignment)* ซึ่งจะต้องบอกเครื่องว่าชื่อของตัวแปรคืออะไร และค่าที่ต้องการ คำสั่งภาษาไพธอนมีกฏดังนี้
```
ชิื่อตัวแปร = ค่่าที่ต้องการเก็บ
```
ตัวอย่าง เช่น ถ้าเราต้องการสร้างตัวแปรที่ชื่อว่า `num_words` เพื่อให้เก็บจำนวนคำที่เรานับมาได้จากบทความชิ้นหนึ่ง ซึ่งสมมติว่ามีค่าเท่ากับ 5000
```
num_words = 5000
```
ข้อควรระวังอย่างหนึ่งคือ ชื่อตัวแปรจะต้องมีลักษณะดังนี้ คือ
- ต้องขึ้นต้นด้วยตัวอักษรเท่านั้น (ห้ามใช้ตัวเลขหรือเครื่องหมายขึ้นต้น)
- ห้ามใช้คำที่สงวน เช่น `for` `while` `def` ฯลฯ ซึ่งเป็นคำที่สงวนใช้สร้างคำสั่งอื่น ๆ 
- ห้ามมีช่องว่างเลย

```{margin}
ตัว `>>>` ที่ปรากฏอยู่หน้าคำสั่งมีไว้เพื่อแสดงให้เห็นว่าเป็นการพิมพ์คำสั่งไพธอนลงไปบน `ipython`
```

ถ้าเกิดว่าไม่เขียนคำสั่งตามกฏ interpreter จะชี้บอกว่าเจอข้อผิดพลาด (error) ที่ไฟล์ไหน และบรรทัดที่เท่าไร ส่วนไหนของโค้ด และบอกด้วยว่าเป็น `SyntaxError`  เช่น
```
>>> number of words = 5000
  File "myprogram.py", line 1
    number of words = 5000
            ^
SyntaxError: invalid syntax
```
เป็นเพราะใส่ช่องว่างในชื่อตัวแปร

นอกจากนั้นแล้วชื่อตัวแปรที่ดีควรมีลักษณะดังนี้
- บ่งบอกถึงค่าที่ตัวแปรนั้นเก็บไว้ เช่น `num_words` เพื่อเก็บจำนวนคำ 
- เป็นคำนาม เพราะว่าตัวแปรเปรียบได้กับสิ่งของ 
- ควรเป็นตัวภาษาอังกฤษ ตัวเล็กทั้งหมด
- ถ้าชื่อตัวแปรมีหลายคำประกอบกันให้ ให้คั่นแต่ละคำด้วยตัวขีดล่าง `_` เช่น `number_of_words`
- อย่าให้มีความยาวจนเกินไป

ทั้งนี้เพราะหากมีตัวแปรหลายตัว อาจจะสับสนได้ว่าตัวแปรไหนเก็บอะไร ทำให้ทำความเข้าใจและแก้ไขโค้ดได้ลำบาก โดยเฉพาะอย่างยิ่งเวลานำโค้ดเป็นทีม จะต้องเขียนโค้ดให้คนในทีมอ่านรู้เรื่องได้ง่ายด้วย

สมมติว่าเราต้องการหาจำนวนคำโดยไม่นับเครื่องหมายวรรคตอน เพื่อให้ได้จำนวนคำที่แท้จริง สมมติว่าเราจำนวนเครื่องหมายวรรคตอนที่นับได้เท่ากับ 200 ตัว เราสามารถหาจำนวนโดยการสร้างตัวแปรขึ้นมาอีกตัวและหักลบกันดังนี้
```
num_words = 5000
num_punctuations = 200
num_words_no_puncs = num_words - num_punctuations
```
หากเราอยากทราบค่าของ `num_word_no_puncs` เราสามารถบอกให้เครื่องแสดงผลออกมาได้
```
>>> print(num_words_no_puncs)
4800
```
โค้ดที่อยู่ทางขวาของเครื่องหมาย `=` เรียกว่า *นิพจน์ (expression)* ซึ่งก็คือการนำตัวแปร ค่าคงที่มากระทำต่อกัน อย่างเช่นในตัวอย่างข้างบนที่เรานำตัวแปร `num_words` กับ `num_punctuations` มาลบกันโดยใช้ตัวดำเนินการ (operator) `-` 

เวลาสร้างตัวแปรใหม่ Python interpreter จะแปลผลจาก expression ก่อนแล้วค่อยให้ค่ากับตัวแปรที่มีชื่ออยู่ทางซ้ายมือ เพราะฉะนั้นลองคิดว่าดูว่าโค้ดข้างล่างนี้จะแสดงผลอะไรออกมา

```python
num_words = 5000
num_punctuations = 200
num_words_no_puncs = num_words - num_punctuations
num_punctations = 1000
print (num_words_no_puncs)
```
คำตอบคือ 4800 เท่าเดิมเนื่องจากเครื่องตีความผลของ `num_words - num_punctuations` ไปเสร็จเรียบร้อยแล้ว การแก้ค่าของตัวแปร `num_punctuations = 1000` ในบรรทัดต่อมา ไม่มีผลต่อค่าของ `num_words_no_puncs` ที่ถูกจัดเก็บไว้แล้ว


## ชนิดของตัวแปร (variable type) และข้อมูล (data type)
ตัวแปรในภาษาไพธอนมีหลายชนิด (type)
- `int` ย่อมาจาก integer มีไว้เก็บจำนวนเต็ม ตัวเลขที่ไม่มีจุดทศนิยม
- `float` มีไว้เก็บจำนวนที่มีจุดทศนิยม
- `str` สตริงมีไว้เก็บข้อความ
- `bool` มีไว้เก็บบูลีน (boolean) ที่มีค่า `True` หรือ `False`

และยังมีอีกมากซึ่งเราจะได้เห็นในบทต่อ ๆ ไป 

เวลาเราสร้างตัวแปรและกำหนดค่าให้ตัวแปร เราไม่ต้องเลือกเลยว่าจะต้องใช้ตัวแปรชนิดใด เพราะว่า python interpreter จะแปลค่าจาก expression ที่อยู่ทางด้านขวามือและรู้เองว่าต้องใช้ตัวแปรชนิดใด แต่เราจำเป็นต้องรู้เองว่า expression ได้ผลออกมาเป็นชนิดใด เพื่อจะเลือก operator ใช้ได้ถูกต้อง

### `int` และ `float`
เราสามารถสร้าง expression ที่ประกอบด้วย `int` และ `float` ด้วยตัวดำเนินการเลขคณิต (arithmetic operator)
 ในภาษาไพธอนมีดังนี้

| Operator | ความหมาย | ตัวอย่าง |
| -------- | ---------| -------|
| + | บวก     | 3 + 2 --> 5| 
| - | ลบ      | 3 - 2 --> 1| 
| * | คูณ      | 3 * 2 --> 6| 
| / | หาร     | 3 / 2 --> 1.5| 
| // | หารแบบปัดเศษทิ้ง     | 3 // 2 --> 1| 
| ** | ยกกำลัง | 3 ** 2 --> 9|  
| % | หารแล้วได้เศษ (mod)| 3 % 2 --> 1|

นอกจากนั้นแล้วยังมีตัวดำเนินการเปรียบเทียบ (comparison operator) ที่ให้ค่าเป็นบูลีน 

| Operator | ความหมาย | ตัวอย่าง |
| -------- | ---------| -------|
| > | มากกว่า     | 3 > 2 --> `True`| 
| < | น้อยกว่า     | 3 < 2 --> `False`| 
| == | เท่ากัน      | 3 == 2 --> `False`| 
| != | ไม่เท่ากับ      | 3 != 2 --> `True`| 

ตัวอย่าง เช่น 

```python
num_words = 5000
pi = 3.14
average_words_per_page = num_words / 6
```
ทั้ง `pi` และ `average_words_per_page` เป็นตัวแปรประเภท `float` เพราะ Python interpreter แปลผล expression ทางขวามือแล้วได้ค่าที่เป็นทศนิยม 

### สตริง
เบื้องต้นเราสามารถสร้างสตริงเพื่อเก็บข้อความได้ดังนี้

```python
welcome_message = 'Welcome to my world!'
```
`welcome_message` เป็นตัวแปรชนิดสตริง เนื่องจาก expression เป็นข้อความโดยเห็นได้จากเครื่อง `'` ที่คร่อมข้อความอยู่ 

เราจะศึกษารายละเอียดของการสร้างสตริงในรูปอื่น ๆ ทั้งหมด และ operator ของสตริง เช่น `+` และ `*` ในส่วนต่อไปของบทนี้ 

### บูลีน
ค่าบูลีนสามารถเป็นได้แค่ `True` หรือ `False` ให้สังเกตว่าทั้งสองค่านั้นต้องสะกดด้วยตัวใหญ่ตัวแรก

นอกจากนั้นแล้วยังสามารถขึ้นมาได้ด้วยการใช้ comparison operator อีกด้วย
```python
is_long_book = num_words > 10000
```
จากตัวอย่างข้างบน `is_long_book` เป็นตัวแปรชนิดบูลีน เพราะว่า expression ตีผลออกมาเป็น `False` 

operator ของบูลีนกับบูลีน ได้แก่ `and` `or` เราได้เห็นและใช้กันไปแล้วในบทที่ 1 

## ฟังก์ชัน (function)
ในบทที่หนึ่งเราได้เรียนรู้วิธีการเขียนฟังก์ชันที่สามารถนำกลับมาใช้อีกได้ในสถานการณ์ใกล้ ๆ กัน เพื่อช่วยย่อยโจทย์ออกมาเป็นส่วนย่อย ๆ และเป็นการประหยัดโค้ดอีกด้วย ที่จริงแล้วฟังก์ชันสามารถเขียนให้มีความยืดหยุ่นมากขึ้นโดยการเขียนฟังก์ชันที่รับอาร์กิวเมนต์ (argument) 

```{image} img/input-output.png
:height: 100px
:align: center
```

```{margin} คำศัพท์
parameter คือ ตัวแปรที่เป็นส่วนหนึ่งของการประกาศฟังก์ชัน
argument คือ ค่าเราให้กับ parameter ตอนเรียกใช้ฟังก์ชัน

แต่ว่าคนมักจะใช้สองคำนี้ปนกันบ่อยมาก จนกลายเป็นว่าเป็นคำที่ใช้แทนกันได้
```

ฟังก์ชันเหมือนกับฟังก์ชันทางคณิตศาสตร์ คือ มี 
- input ซึ่งในภาษาคอมพิวเตอร์เราเรียกว่า parameter หรือ argument 
- output ซึ่งในภาษาคอมพิวเตอร์เราเรียกว่า ค่ารีเทิร์น (return value)

ตัวอย่างฟังก์ชันที่เขียนเป็นโค้ดได้จะต้องกำหนดประเภทของข้อมูลด้วยว่าเป็นประเภทไหน เช่น 
- ฟังก์ชันหาค่าเฉลี่ยของเลขสองตัว
  - input คือ เลขสองตัว
  - output คือ ตัวเลขค่าเฉลี่ย
- ฟังก์ชันคำนวณพื้นที่สามเหลี่ยม 
  - input คือ ความยาวฐาน (`int` หรือ `float`) และความสูง (`int` หรือ `float`)
  - output คือ พื้นที่ (`float`) ที่ต้องเป็น `float` เนื่องจากตัวหารจะให้ผลลัพท์เป็น `float` เสมอ 
- ฟังก์ชันเปรียบเทียบความยาวข้อความว่าอันไหนยาวกว่า
  - input คือ ข้อความสองข้อความ (สตริง)
  - output คือ ค่าบอกว่าข้อความไหนยาวกว่า (บูลีน)
- ฟังก์ชันคำนวณภาษีมูลค่าเพิ่ม
  - input คือ ยอดซื้อ อัตราภาษี และตัวเลือกว่าจะปัดเศษหรือไม่
  - output คือ ภาษี

เราจะสังเกตได้ว่าฟังก์ชันมีความยืดหยุ่นสูงสามารถปรับใช้ในสถานการณ์ต่าง ๆ ได้โดยการปรับค่า argument ของแต่ละฟังก์ชัน เช่น วันหนึ่งถ้าอัตราภาษีมีการปรับเปลี่ยน เราก็ไม่ต้องเขียนฟังก์ชันใหม่ เราแค่ใส่อัตราภาษีใหม่เข้าไปเป็น input

### การประกาศฟังก์ชันแบบมี argument 

ฟังก์ชันแบบมี argument ในภาษาไพธอนมีลักษณะดังนี้
```python
def compute_vat(amount, vat_rate, round_decimal):
  vat = amount * vat_rate
  if round_decimal:
    return int(vat)
  else:
    return vat
```

นี่คือฟังก์ชันที่คำนวณภาษีมูลค่าเพิ่มจากยอดการซื้อ โดยปรับได้ด้วยว่าจะให้ปัดทศนิยมด้วยหรือไม่ ฟังก์ชันภาษาไพธอนมีกฏดังนี้

- ต้องขึ้นต้นด้วยคำว่า `def` ตามด้วยชื่อฟังก์ชัน ตามด้วยวงเล็บ ตามด้วยชื่อ argument ทั้งหมด แต่ละตัวคั่นด้วย `,` และบรรทัดการประกาศฟังก์ชันด้วย `:` 
- ตัวเนื้อหาฟังก์ชันต้องมีการเคาะย่อหน้า
- ควรจะต้องมีการ `return` output ออกจากฟังก์ชัน 

โดยทั่วไปแล้วกฏไวยากรณ์ของการประกาศฟังก์ชัน มีดังนี้
```
def ชื่อฟังก์ชัน(argument1, argument2):
  ตัวเนื้อหาฟังก์ชัน
  return ค่าที่ต้องการรีเทิร์น
```

ข้อสังเกตที่สำคัญ คือ argument ของภาษาไพธอนจะไม่มีการบังคับชนิดของข้อมูลเอาไว้อย่างชัดเจน ทำให้เกิดข้อผิดพลาดได้เวลานำฟังก์ชันไปใช้ เพราะผู้ใช้อาจจะนำข้อมูลมาใส่ผิดประเภท เช่น ถ้านำสตริงมาใส่แทนตัวเลข เครื่องจะให้ error กลับคืนมาเมื่อนำสตริงไปคูณกับสตริง เพราะว่าการคูณสตริงไม่มีความหมายใด ๆ เพราะฉะนั้นเราอาจจะเขียนกำกับ (type annotation) ไว้ในฟังก์ชันได้ว่า argument ควรจะเป็นข้อมูลชนิดอะไร เช่น

```python
def compute_vat(amount:float, vat_rate:float, round_decimal:bool):
  vat = amount * vat_rate
  if round_decimal:
    return int(vat)
  else:
    return vat
```
argument แต่ละตัวถูกเขียนกำกับว่าเป็น type อะไรโดยการเขียน `:type` ลงท้าย argument แต่ละตัว 
การกำกับ type ในลักษณะนี้เป็นการช่วยเหลือคนเขียนโปรแกรมเท่านั้น ทำให้รู้ว่าฟังก์ชันรับ input มาเป็นอะไรบ้าง และตัว IDE ก็นำข้อมูลนี้ไปช่วยตรวจสอบโค้ดให้ได้ในระดับหนึ่ง แต่ว่าเครื่องไม่ได้ช่วยตรวจจับ error ตอนนำฟังก์ชันไปใช้แต่อย่างใด และจะเห็นได้ว่าฟังก์ชันจะดูรก ไม่สะอาดตาเหมือนก่อน คนจึงไม่ค่อยนิยมเขียนกำกับ type เท่าไรนัก

### การเรียกฟังก์ชัน (function call)


## การตรวจสอบและเปลี่ยนแปลง type

เราสามารถตรวจสอบประเภทของตัวแปรโดยคำสั่ง `type` เช่น
```
>>> num_words = 5000
>>> average_words_per_page = num_words / 6
>>> print(type(average_words_per_page))
<class 'float'>
```
และ
```
>>> welcome_message = 'Welcome to my world!'
>>> print(type(welcome_message))
<class 'str'>
```